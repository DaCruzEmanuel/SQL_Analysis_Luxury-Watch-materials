-- 1. check the whole luxury watch table

Select *
from luxurywatches


-- 2. List all Watch brands

Select 
	distinct Brand
from 
	luxurywatches


-- 3. Display the total number of Watch Brands

Select  
	COUNT (distinct Brand) TotalNumberOfBrands
from 
	luxurywatches


-- 4. Display the total number of models by Brand

select 
	brand,
	count (distinct model) as NumberOfBrands
from
	LuxuryWatches
Group by
	brand	
order by
	NumberOfBrands desc


-- 5. List all models by Watch Brand

select
	distinct Brand, 
	Model
from
	LuxuryWatches
order by
	brand, model


-- 6. List all case materials

select 
	distinct casematerial
from
	LuxuryWatches


-- 7. List all Strap materials

select
	distinct strapmaterial
from
	LuxuryWatches


-- 8. Average price by case and strap material

select
	CaseMaterial,
	StrapMaterial, 
	Avg(price_usd) as AveragePrice
from
	LuxuryWatches
group by
	CaseMaterial,
	StrapMaterial
order by 
	AveragePrice desc


-- 9. Distribution of movement types (count watches by 

select
	MovementType,
	count(*) as NumberOfWatches
from 
	Luxurywatches
group by
	MovementType
order by 
	NumberOfWatches desc


-- 10. Correlation between water resistance and case and strap material:

select 
	CaseMaterial,
	StrapMaterial,
	concat(avg(WaterResistance_meters),' ','meters') as AverageWaterResistance
from 
	Luxurywatches
group by 
	CaseMaterial,
	StrapMaterial
order by
	CaseMaterial, AverageWaterResistance desc


-- 11. Average case diameter and thickness by brand:

select
	Brand,
	concat(avg(CaseDiameter_mm),' ','mm') AverageCaseDiameter,
	concat(avg(CaseThickness_mm),' ','mm') AverageCaseThickness
from
	Luxurywatches
group by
	brand
order by 
	AverageCaseDiameter desc, AverageCaseThickness desc


-- 12. Common features in high-priced watches:

select 
	Top 10 Brand,
	Model,
	CaseMaterial,
	StrapMaterial,
	max(price_usd) HighestPrice
from
	Luxurywatches
group by
	Brand,
	Model,
	CaseMaterial,
	StrapMaterial
order by
	HighestPrice desc


-- 13. The top 20 most expensive Watches

SELECT 
	TOP 20 Brand, 
	Model, 
	Price_usd
FROM 
	LuxuryWatches
ORDER BY 
	Price_usd DESC

-- 14. The most expensive Watches by each Brand

WITH Price_Rank as
(
select 
	Brand, 
	model, 
	price_usd,
	row_number() over (partition by brand order by price_usd desc) as rk
from 
	LuxuryWatches
)
select 
	Brand, 
	Model, 
	Price_usd
from 
	Price_Rank
where 
	rk = 1
order by
	Price_usd desc

-- Set the price category for each Brand and Model

select 
	Brand, 
	model, 
	Price_usd,
		Case 
			when price_usd >=35000 then 'High'
			when price_usd >=10000 then 'medium'
		else 'low'
	end Price_Category
from 
	LuxuryWatches
order by 
	Price_usd desc